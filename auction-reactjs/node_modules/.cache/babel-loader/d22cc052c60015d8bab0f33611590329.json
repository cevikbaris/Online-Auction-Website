{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\bar1s\\\\Desktop\\\\react\\\\auction\\\\src\\\\Pages\\\\Auction.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect } from 'react';\nimport './Auction.css';\nimport Input from '../Components/Input';\nimport { useParams } from 'react-router-dom';\nimport { getAuction, maxBidOfAuction, createBid, buyNow, postAutoBidding } from '../Api/ApiCalls';\nimport { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useCountdown } from '../Components/Countdown';\nimport ButtonWithProgress from '../Components/ButtonWithProgress';\nimport { useSelector } from 'react-redux';\nimport { useApiProgress } from '../Shared/ApiProgress';\nimport Spinner from '../Components/Spinner';\nimport Modal from '../Components/Modal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Auction = props => {\n  _s();\n\n  const [auction, setAuction] = useState({\n    bids: [],\n    name: null,\n    username: null,\n    buyer: null,\n    category: null,\n    endDate: null,\n    explanation: null,\n    fileAttachment: null,\n    sellNowPrice: null,\n    startDate: null,\n    startPrice: null,\n    title: null,\n    minimumIncrease: null\n  });\n  const [bidder, setBidder] = useState({\n    name: null,\n    price: null,\n    username: null\n  });\n  const [notFound, setNotFound] = useState(false);\n  const [errors, setError] = useState({});\n  const [price, setPrice] = useState(null);\n  const [isBidded, setIsBidded] = useState(false);\n  const [modalVisible, setModalVisible] = useState(false);\n  const [samePriceError, setSamePriceError] = useState(undefined);\n  const [buyNowModalVisible, setBuyNowModalVisible] = useState(false);\n  const [automaticModalVisible, setAutomaticModalVisible] = useState(false);\n  const [maxBidLimit, setMaxBidLimit] = useState(null);\n  const params = useParams();\n  let {\n    id\n  } = params;\n  const {\n    username: loggedInUsername,\n    isLoggedIn,\n    isApproved\n  } = useSelector(store => ({\n    username: store.username,\n    isLoggedIn: store.isLoggedIn,\n    isApproved: store.isApproved\n  }));\n  const pendingApiCall = useApiProgress('get', `/auction/${id}`);\n  const bidPendingApiCall = useApiProgress('post', '/auction/bid');\n  const pendingApiCallBuyNow = useApiProgress('put', '/auction/buy-now');\n  useEffect(() => {\n    loadAuction();\n    loadBidder();\n    setNotFound(false);\n  }, []);\n  useEffect(() => {\n    loadAuction();\n  }, [bidder]);\n\n  const loadAuction = async () => {\n    try {\n      const response = await getAuction(id);\n      setAuction(response.data);\n    } catch (error) {\n      setNotFound(true);\n    }\n  };\n\n  const loadBidder = async () => {\n    try {\n      const response = await maxBidOfAuction(id);\n      setBidder(response.data);\n      setIsBidded(true);\n    } catch (error) {\n      setIsBidded(false);\n    }\n  };\n\n  const {\n    endDate,\n    explanation,\n    fileAttachment,\n    sellNowPrice,\n    startPrice,\n    title,\n    name,\n    username,\n    minimumIncrease\n  } = auction;\n  const isOwner = username === loggedInUsername;\n  const [days, hours, minutes, seconds] = useCountdown(endDate);\n  const isFinished = days + hours + minutes + seconds <= 0;\n\n  const onClickBid = async () => {\n    var time = new Date();\n    const body = {\n      buyerUsername: loggedInUsername,\n      price: price,\n      auctionID: id,\n      bidTime: time\n    };\n\n    try {\n      const response = await createBid(body);\n      setBidder(response.data);\n      setIsBidded(true);\n    } catch (error) {\n      console.log(error.response.data);\n\n      if (error.response.data.status === 500) {\n        setSamePriceError('You can not bid the same price');\n      }\n    } finally {\n      setModalVisible(false);\n    }\n  };\n\n  const onChangePrice = event => {\n    const {\n      name,\n      value\n    } = event.target;\n\n    if (value <= startPrice || value <= bidderPrice) {\n      setError(previousError => ({ ...previousError,\n        [name]: 'Bid price must be greater than last price'\n      }));\n    } else if (value <= startPrice + minimumIncrease) {\n      setError(previousError => ({ ...previousError,\n        [name]: 'Bid price must be greater than minimum bid increasing'\n      }));\n    } else {\n      setError(previousError => ({ ...previousError,\n        [name]: undefined\n      }));\n      setPrice(value);\n    }\n  };\n\n  const onChangeMaxLimit = event => {\n    const {\n      name,\n      value\n    } = event.target;\n\n    if (value < startPrice + minimumIncrease) {\n      setError(previousError => ({ ...previousError,\n        [name]: 'Automatic bid limit must be higher than last price + minimum increase'\n      }));\n    } else {\n      setMaxBidLimit(value);\n      setError(previousError => ({ ...previousError,\n        [name]: undefined\n      }));\n    }\n  };\n\n  const {\n    bid: bidError,\n    automaticBid: automaticBidError\n  } = errors;\n\n  const onClickCancel = () => {\n    setModalVisible(false);\n  };\n\n  const onClickBuyNow = async () => {\n    var time = new Date();\n    const body = {\n      buyerUsername: loggedInUsername,\n      price: sellNowPrice,\n      auctionID: id,\n      bidTime: time\n    };\n\n    try {\n      const response = await buyNow(body);\n      setBidder(response.data);\n      setIsBidded(true);\n    } catch (error) {\n      console.log(error);\n    } finally {\n      setBuyNowModalVisible(false);\n    }\n  };\n\n  const createAutoBidding = async () => {\n    const body = {\n      maxBidLimit,\n      auctionId: id,\n      username: loggedInUsername\n    };\n\n    try {\n      await postAutoBidding(body);\n      setAutomaticModalVisible(false);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const {\n    name: bidderName,\n    username: bidderUsername,\n    price: bidderPrice\n  } = bidder;\n  let showTime = \"\";\n  let html = \"\";\n\n  if (pendingApiCall) {\n    html = /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 16\n    }, this);\n  } else {\n    if (!isFinished) {\n      showTime = `${days} days ${hours} hours ${minutes} minutes ${seconds} seconds`;\n      html = /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-danger\",\n          children: showTime\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 17\n        }, this), isLoggedIn && !isOwner && (isApproved ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"action my-2 form-group row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-12 row \",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-7  my-auto\",\n              children: /*#__PURE__*/_jsxDEV(Input, {\n                labelClassName: \"font-weight-bold\",\n                label: `Enter your bid. (Minimum increase +$${minimumIncrease})`,\n                name: \"bid\",\n                id: \"price\",\n                type: \"text\",\n                onChange: onChangePrice,\n                error: bidError || samePriceError\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 214,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-5 my-auto\",\n              children: /*#__PURE__*/_jsxDEV(ButtonWithProgress, {\n                className: \"pl-5 pr-5  py-2 pb-2 btn btn-success\",\n                pendingApiCall: bidPendingApiCall || pendingApiCall,\n                text: \"BID\",\n                onClick: () => setModalVisible(true),\n                disabled: bidError || price == null\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-12 row \",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-7  my-auto\",\n              children: /*#__PURE__*/_jsxDEV(Input, {\n                labelClassName: \"font-weight-bold\",\n                label: \"Enter automatic bidding limit.\",\n                name: \"automaticBid\",\n                type: \"text\",\n                onChange: onChangeMaxLimit,\n                error: automaticBidError\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-5 my-auto\",\n              children: /*#__PURE__*/_jsxDEV(ButtonWithProgress, {\n                className: \"py-2 pb-2 btn btn-success\",\n                text: \"CREATE AUTO BID\",\n                onClick: () => setAutomaticModalVisible(true),\n                disabled: automaticBidError\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-12 \",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"font-weight-bold\",\n              children: [\"Buy Now:  \", /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [\" $\", Number(sellNowPrice).toLocaleString()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 81\n              }, this), /*#__PURE__*/_jsxDEV(ButtonWithProgress, {\n                className: \"pl-5 pr-5  py-2 pb-2 ml-4 btn btn-danger\",\n                text: \"BUY NOW \",\n                onClick: () => setBuyNowModalVisible(true)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 32\n        }, this) : /*#__PURE__*/_jsxDEV(Link, {\n          className: \"btn btn-success\",\n          to: `/verify/${loggedInUsername}`,\n          children: \" Verify your account to bid \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 31\n        }, this)), !isLoggedIn && /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/login\",\n          className: \"action my-2\",\n          children: \"Login to bid\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 33\n        }, this)]\n      }, void 0, true);\n    } else {\n      html = /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-danger\",\n        children: \"\\\"Auction is over\\\"\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 21\n      }, this);\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container my-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card mt \",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container-fliud my-5\",\n        children: [!notFound && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"wrapper row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"carouselExampleControls\",\n            className: \"carousel slide preview col-md-6\",\n            \"data-ride\": \"carousel\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"carousel-inner\",\n              children: fileAttachment && /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [fileAttachment.fileType.startsWith('image') && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"carousel-item active\",\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: 'images/attachments/' + fileAttachment.name,\n                    className: \"d-block w-100\",\n                    alt: fileAttachment.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 265,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 45\n                }, this), !fileAttachment.fileType.startsWith('image') && /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Unknown attachment\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 48\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n              className: \"carousel-control-prev\",\n              href: \"#carouselExampleControls\",\n              role: \"button\",\n              \"data-slide\": \"prev\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"carousel-control-prev-icon\",\n                \"aria-hidden\": \"true\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"sr-only\",\n                children: \"Previous\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 276,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n              className: \"carousel-control-next\",\n              href: \"#carouselExampleControls\",\n              role: \"button\",\n              \"data-slide\": \"next\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"carousel-control-next-icon\",\n                \"aria-hidden\": \"true\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 279,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"sr-only\",\n                children: \"Next\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 280,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"details col-md-6 my-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"product-title\",\n              children: title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n              children: [\" Seller : \", /*#__PURE__*/_jsxDEV(Link, {\n                to: `/user/${username}`,\n                children: [\" \", name, \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 44\n              }, this), \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 287,\n                columnNumber: 34\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n              children: \"Description\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"product-description\",\n              children: explanation\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 34\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 29\n            }, this), isBidded && /*#__PURE__*/_jsxDEV(\"h5\", {\n              children: [\"Highest Bid:  \", /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-success\",\n                children: [\" $\", Number(bidderPrice).toLocaleString()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 60\n              }, this), \" -\", /*#__PURE__*/_jsxDEV(Link, {\n                to: `/user/${bidderUsername}`,\n                children: [bidderName, \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 140\n              }, this), \"  \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 42\n            }, this), !isBidded && /*#__PURE__*/_jsxDEV(\"h4\", {\n              children: [\"Current Price: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-success\",\n                children: [\"$\", Number(startPrice).toLocaleString()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 63\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 43\n            }, this), pendingApiCall ? /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 47\n            }, this) : html, isFinished && /*#__PURE__*/_jsxDEV(\"h5\", {\n              children: [\"Winner !! \", bidderName, \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 44\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 36\n        }, this), notFound && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"alert alert-danger\",\n          role: \"alert\",\n          children: /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Auction not found\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 35\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      visible: modalVisible,\n      onClickCancel: onClickCancel,\n      onClickOk: onClickBid,\n      pendingApiCall: bidPendingApiCall,\n      title: \"Bid On Product\",\n      okButtonText: \"Make A Bid\",\n      message: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [\"Are you sure you want to bid?\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 33\n            }, this), \"Your bid : \", price, \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      visible: buyNowModalVisible,\n      onClickCancel: () => setBuyNowModalVisible(false),\n      onClickOk: onClickBuyNow,\n      pendingApiCall: pendingApiCallBuyNow,\n      title: \"Buy Now Product\",\n      okButtonText: \"Buy now\",\n      message: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Are you sure you want to buy?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 29\n          }, this), \"If you buy now the auction will be closed and you will be the winner.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [\" Buy now price : \", /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\" $\", Number(sellNowPrice).toLocaleString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 54\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      visible: automaticModalVisible,\n      onClickCancel: () => setAutomaticModalVisible(false),\n      onClickOk: createAutoBidding //pendingApiCall={bidPendingApiCall}\n      ,\n      title: \"Automatic Bidding\",\n      okButtonText: \"Ok\",\n      message: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"The system will renew your bid until  reach the limit.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 25\n        }, this), \"Your limit : $\", Number(maxBidLimit).toLocaleString()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 254,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Auction, \"jmLNKRBmMvWvcxbNuzjwt8g9DZE=\", false, function () {\n  return [useParams, useSelector, useApiProgress, useApiProgress, useApiProgress, useCountdown];\n});\n\n_c = Auction;\nexport default Auction;\n\nvar _c;\n\n$RefreshReg$(_c, \"Auction\");","map":{"version":3,"names":["React","useEffect","Input","useParams","getAuction","maxBidOfAuction","createBid","buyNow","postAutoBidding","useState","Link","useCountdown","ButtonWithProgress","useSelector","useApiProgress","Spinner","Modal","Auction","props","auction","setAuction","bids","name","username","buyer","category","endDate","explanation","fileAttachment","sellNowPrice","startDate","startPrice","title","minimumIncrease","bidder","setBidder","price","notFound","setNotFound","errors","setError","setPrice","isBidded","setIsBidded","modalVisible","setModalVisible","samePriceError","setSamePriceError","undefined","buyNowModalVisible","setBuyNowModalVisible","automaticModalVisible","setAutomaticModalVisible","maxBidLimit","setMaxBidLimit","params","id","loggedInUsername","isLoggedIn","isApproved","store","pendingApiCall","bidPendingApiCall","pendingApiCallBuyNow","loadAuction","loadBidder","response","data","error","isOwner","days","hours","minutes","seconds","isFinished","onClickBid","time","Date","body","buyerUsername","auctionID","bidTime","console","log","status","onChangePrice","event","value","target","bidderPrice","previousError","onChangeMaxLimit","bid","bidError","automaticBid","automaticBidError","onClickCancel","onClickBuyNow","createAutoBidding","auctionId","bidderName","bidderUsername","showTime","html","Number","toLocaleString","fileType","startsWith"],"sources":["C:/Users/bar1s/Desktop/react/auction/src/Pages/Auction.js"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport './Auction.css'\r\nimport Input from '../Components/Input';\r\nimport { useParams } from 'react-router-dom';\r\nimport { getAuction, maxBidOfAuction, createBid, buyNow, postAutoBidding } from '../Api/ApiCalls';\r\nimport { useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { useCountdown } from '../Components/Countdown';\r\nimport ButtonWithProgress from '../Components/ButtonWithProgress';\r\nimport { useSelector } from 'react-redux';\r\nimport { useApiProgress } from '../Shared/ApiProgress';\r\nimport Spinner from '../Components/Spinner';\r\nimport Modal from '../Components/Modal';\r\n\r\n\r\n\r\nconst Auction = (props) => {\r\n    const [auction, setAuction] = useState({\r\n        bids: [],\r\n        name: null,\r\n        username: null,\r\n        buyer: null,\r\n        category: null,\r\n        endDate: null,\r\n        explanation: null,\r\n        fileAttachment: null,\r\n        sellNowPrice: null,\r\n        startDate: null,\r\n        startPrice: null,\r\n        title: null,\r\n        minimumIncrease: null\r\n    });\r\n    const [bidder, setBidder] = useState({\r\n        name: null,\r\n        price: null,\r\n        username: null,\r\n    });\r\n\r\n    const [notFound, setNotFound] = useState(false);\r\n    const [errors, setError] = useState({});\r\n    const [price, setPrice] = useState(null);\r\n    const [isBidded, setIsBidded] = useState(false);\r\n    const [modalVisible, setModalVisible] = useState(false);\r\n    const [samePriceError, setSamePriceError] = useState(undefined);\r\n    const [buyNowModalVisible, setBuyNowModalVisible] = useState(false);\r\n    const [automaticModalVisible, setAutomaticModalVisible] = useState(false);\r\n    const [maxBidLimit, setMaxBidLimit] = useState(null);\r\n\r\n    const params = useParams();\r\n    let { id } = params;\r\n\r\n    const { username: loggedInUsername, isLoggedIn, isApproved } = useSelector(store => ({\r\n        username: store.username,\r\n        isLoggedIn: store.isLoggedIn,\r\n        isApproved: store.isApproved\r\n    }))\r\n\r\n    const pendingApiCall = useApiProgress('get', `/auction/${id}`);\r\n    const bidPendingApiCall = useApiProgress('post', '/auction/bid');\r\n    const pendingApiCallBuyNow = useApiProgress('put', '/auction/buy-now')\r\n\r\n    useEffect(() => {\r\n        loadAuction();\r\n        loadBidder();\r\n        setNotFound(false);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        loadAuction();\r\n    }, [bidder])\r\n\r\n    const loadAuction = async () => {\r\n        try {\r\n            const response = await getAuction(id);\r\n            setAuction(response.data);\r\n        } catch (error) {\r\n            setNotFound(true);\r\n        }\r\n    }\r\n\r\n    const loadBidder = async () => {\r\n        try {\r\n            const response = await maxBidOfAuction(id);\r\n            setBidder(response.data);\r\n            setIsBidded(true);\r\n        } catch (error) {\r\n            setIsBidded(false);\r\n        }\r\n    }\r\n\r\n\r\n    const { endDate, explanation, fileAttachment, sellNowPrice, startPrice, title, name, username, minimumIncrease } = auction;\r\n\r\n    const isOwner = (username === loggedInUsername);\r\n    const [days, hours, minutes, seconds] = useCountdown(endDate);\r\n\r\n    const isFinished = (days + hours + minutes + seconds <= 0);\r\n\r\n\r\n    const onClickBid = async () => {\r\n        var time = new Date();\r\n        const body = {\r\n            buyerUsername: loggedInUsername,\r\n            price: price,\r\n            auctionID: id,\r\n            bidTime: time\r\n        }\r\n        try {\r\n            const response = await createBid(body);\r\n            setBidder(response.data);\r\n            setIsBidded(true);\r\n        } catch (error) {\r\n            console.log(error.response.data);\r\n            if (error.response.data.status === 500) {\r\n                setSamePriceError('You can not bid the same price');\r\n            }\r\n        }\r\n        finally {\r\n            setModalVisible(false);\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    const onChangePrice = (event) => {\r\n        const { name, value } = event.target;\r\n\r\n        if (value <= startPrice || value <= bidderPrice) {\r\n            setError((previousError) => ({ ...previousError, [name]: 'Bid price must be greater than last price' }));\r\n        } else if (value <= (startPrice + minimumIncrease)) {\r\n            setError((previousError) => ({ ...previousError, [name]: 'Bid price must be greater than minimum bid increasing' }));\r\n        }\r\n        else {\r\n            setError((previousError) => ({ ...previousError, [name]: undefined }));\r\n            setPrice(value);\r\n\r\n        }\r\n    }\r\n    const onChangeMaxLimit = (event) => {\r\n        const { name, value } = event.target;\r\n        if (value < (startPrice + minimumIncrease)) {\r\n            setError((previousError) => ({ ...previousError, [name]: 'Automatic bid limit must be higher than last price + minimum increase' }));\r\n        } else {\r\n            setMaxBidLimit(value);\r\n            setError((previousError) => ({ ...previousError, [name]: undefined }));\r\n        }\r\n    }\r\n\r\n    const { bid: bidError, automaticBid: automaticBidError } = errors;\r\n\r\n\r\n    const onClickCancel = () => {\r\n        setModalVisible(false)\r\n    }\r\n\r\n    const onClickBuyNow = async () => {\r\n        var time = new Date();\r\n        const body = {\r\n            buyerUsername: loggedInUsername,\r\n            price: sellNowPrice,\r\n            auctionID: id,\r\n            bidTime: time\r\n        }\r\n        try {\r\n            const response = await buyNow(body);\r\n            setBidder(response.data);\r\n            setIsBidded(true);\r\n        } catch (error) {\r\n            console.log(error);\r\n        } finally {\r\n            setBuyNowModalVisible(false);\r\n        }\r\n\r\n    }\r\n\r\n    const createAutoBidding = async () => {\r\n        const body = {\r\n            maxBidLimit,\r\n            auctionId: id,\r\n            username: loggedInUsername\r\n        }\r\n        try {\r\n            await postAutoBidding(body);\r\n            setAutomaticModalVisible(false);\r\n\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n    }\r\n\r\n    const { name: bidderName, username: bidderUsername, price: bidderPrice } = bidder;\r\n\r\n    let showTime = \"\";\r\n    let html = \"\";\r\n\r\n    if (pendingApiCall) {\r\n        html = <Spinner />\r\n    } else {\r\n        if (!isFinished) {\r\n            showTime = `${days} days ${hours} hours ${minutes} minutes ${seconds} seconds`;\r\n\r\n            html = (<>\r\n                <span className=\"text-danger\">{showTime}</span>\r\n                <br />\r\n\r\n                {isLoggedIn &&\r\n                    (!isOwner &&\r\n                        (isApproved\r\n                            ? (<div className=\"action my-2 form-group row\">\r\n\r\n                                <div className='col-12 row '>\r\n                                    <div className='col-7  my-auto'>\r\n                                        <Input labelClassName=\"font-weight-bold\" label={`Enter your bid. (Minimum increase +$${minimumIncrease})`}\r\n                                            name='bid' id='price' type=\"text\" onChange={onChangePrice} error={bidError || samePriceError} />\r\n                                    </div>\r\n                                    <div className='col-5 my-auto'>\r\n                                        <ButtonWithProgress className=\"pl-5 pr-5  py-2 pb-2 btn btn-success\" pendingApiCall={bidPendingApiCall || pendingApiCall}\r\n                                            text='BID' onClick={() => setModalVisible(true)} disabled={bidError || (price == null)} />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className='col-12 row '>\r\n                                    <div className='col-7  my-auto'>\r\n                                        <Input labelClassName=\"font-weight-bold\" label='Enter automatic bidding limit.'\r\n                                            name='automaticBid' type=\"text\" onChange={onChangeMaxLimit} error={automaticBidError} />\r\n                                    </div>\r\n                                    <div className='col-5 my-auto'>\r\n                                        <ButtonWithProgress className=\"py-2 pb-2 btn btn-success\"\r\n                                            text='CREATE AUTO BID' onClick={() => setAutomaticModalVisible(true)} disabled={automaticBidError} />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className='col-12 '>\r\n                                    <div className='font-weight-bold'>Buy Now:  <span> ${Number(sellNowPrice).toLocaleString()}</span>\r\n                                        <ButtonWithProgress className='pl-5 pr-5  py-2 pb-2 ml-4 btn btn-danger' text='BUY NOW '\r\n                                            onClick={() => setBuyNowModalVisible(true)} />\r\n                                    </div>\r\n                                </div>\r\n                            </div>)\r\n                            : <Link className=\"btn btn-success\" to={`/verify/${loggedInUsername}`} > Verify your account to bid </Link>\r\n                        )\r\n                    )\r\n                }\r\n                {!isLoggedIn && <Link to=\"/login\" className=\"action my-2\">Login to bid</Link>}\r\n\r\n            </>\r\n            )\r\n        } else {\r\n            html = (<span className=\"text-danger\">\"Auction is over\"</span>);\r\n        }\r\n    }\r\n    return (\r\n        <div className=\"container my-4\">\r\n            <div className=\"card mt \">\r\n                <div className=\"container-fliud my-5\">\r\n                    {!notFound && (<div className=\"wrapper row\">\r\n\r\n                        <div id=\"carouselExampleControls\" className=\"carousel slide preview col-md-6\" data-ride=\"carousel\">\r\n                            <div className=\"carousel-inner\">\r\n                                {fileAttachment && (\r\n                                    <div>\r\n                                        {fileAttachment.fileType.startsWith('image') && (\r\n                                            <div className=\"carousel-item active\">\r\n                                                <img src={'images/attachments/' + fileAttachment.name}\r\n                                                    className=\"d-block w-100\" alt={fileAttachment.name} />\r\n                                            </div>\r\n                                        )}\r\n                                        {!fileAttachment.fileType.startsWith('image')\r\n                                            && <strong>Unknown attachment</strong>}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                            <a className=\"carousel-control-prev\" href=\"#carouselExampleControls\" role=\"button\" data-slide=\"prev\">\r\n                                <span className=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\r\n                                <span className=\"sr-only\">Previous</span>\r\n                            </a>\r\n                            <a className=\"carousel-control-next\" href=\"#carouselExampleControls\" role=\"button\" data-slide=\"next\">\r\n                                <span className=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\r\n                                <span className=\"sr-only\">Next</span>\r\n                            </a>\r\n                        </div>\r\n\r\n                        <div className=\"details col-md-6 my-2\">\r\n                            <h3 className=\"product-title\">{title}</h3>\r\n                            <h5 > Seller : <Link to={`/user/${username}`}> {name} </Link> </h5>\r\n                            <div><hr></hr></div>\r\n\r\n\r\n                            <h5>Description</h5>\r\n                            <p className=\"product-description\">{explanation}</p>\r\n\r\n                            <div><hr></hr></div>\r\n\r\n                            {isBidded && <h5>Highest Bid:  <span className=\"text-success\"> ${Number(bidderPrice).toLocaleString()}</span> -<Link to={`/user/${bidderUsername}`}>{bidderName} </Link>  </h5>}\r\n\r\n                            {!isBidded && <h4 >Current Price: <span className=\"text-success\">${Number(startPrice).toLocaleString()}</span></h4>}\r\n\r\n\r\n\r\n                            {pendingApiCall ? <Spinner /> : html}\r\n\r\n                            {isFinished && <h5>Winner !! {bidderName} </h5>}\r\n\r\n\r\n                        </div>\r\n                    </div>)}\r\n\r\n                    {notFound && (<div className=\"alert alert-danger\" role=\"alert\">\r\n                        <strong>Auction not found</strong>\r\n                    </div>)}\r\n\r\n                </div>\r\n            </div>\r\n            <Modal visible={modalVisible}\r\n                onClickCancel={onClickCancel}\r\n                onClickOk={onClickBid}\r\n                pendingApiCall={bidPendingApiCall}\r\n                title='Bid On Product'\r\n                okButtonText='Make A Bid'\r\n                message={\r\n                    <div>\r\n                        <div>\r\n                            <strong>Are you sure you want to bid?\r\n                                <br></br>\r\n                                Your bid : {price} </strong>\r\n                        </div>\r\n                    </div>\r\n                } />\r\n            <Modal visible={buyNowModalVisible}\r\n                onClickCancel={() => setBuyNowModalVisible(false)}\r\n                onClickOk={onClickBuyNow}\r\n                pendingApiCall={pendingApiCallBuyNow}\r\n                title='Buy Now Product'\r\n                okButtonText='Buy now'\r\n                message={\r\n                    <div>\r\n                        <div>\r\n                            <strong>Are you sure you want to buy?</strong>\r\n                            <br></br>\r\n                            If you buy now the auction will be closed and you will be the winner.\r\n                            <br />\r\n                            <strong> Buy now price : <span> ${Number(sellNowPrice).toLocaleString()}</span> </strong>\r\n                        </div>\r\n                    </div>\r\n                } />\r\n            <Modal visible={automaticModalVisible}\r\n                onClickCancel={() => setAutomaticModalVisible(false)}\r\n                onClickOk={createAutoBidding}\r\n                //pendingApiCall={bidPendingApiCall}\r\n                title='Automatic Bidding'\r\n                okButtonText='Ok'\r\n                message={\r\n                    <div>\r\n                        The system will renew your bid until  reach the limit.\r\n                        <br />\r\n                        Your limit : ${Number(maxBidLimit).toLocaleString()}\r\n                    </div>\r\n                } />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Auction;"],"mappings":"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"},"metadata":{},"sourceType":"module"}