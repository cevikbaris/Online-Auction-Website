{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\bar1s\\\\Desktop\\\\react\\\\auction\\\\src\\\\Components\\\\VerifyAccount.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport Input from './Input';\nimport { useEffect, useState } from 'react';\nimport ButtonWithProgress from './ButtonWithProgress';\nimport { postIdImage, putIdentity } from '../Api/ApiCalls';\nimport { useSelector } from 'react-redux';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst VerifyAccount = props => {\n  _s();\n\n  const [error, setError] = useState();\n  const [newImage, setNewImage] = useState();\n  const [idNumber, setIdNumber] = useState();\n  const [imageId, setImageId] = useState();\n  const [imageError, setImageError] = useState();\n  const [idError, setIdError] = useState();\n  const {\n    username: loggedInUsername\n  } = useSelector(store => ({\n    username: store.username\n  }));\n  const numberRegex = /^[0-9]+$/;\n  useEffect(() => {\n    setError(undefined);\n  }, [newImage, idNumber]);\n  useEffect(() => {\n    setImageError(undefined);\n  }, [imageId]);\n\n  const onChangeFile = event => {\n    if (event.target.files.length < 1) {\n      return;\n    }\n\n    const file = event.target.files[0];\n    const fileReader = new FileReader();\n\n    fileReader.onload = () => {\n      setNewImage(fileReader.result);\n      uploadFile(file);\n    };\n\n    fileReader.readAsDataURL(file);\n  };\n\n  const uploadFile = async file => {\n    const attachment = new FormData();\n    attachment.append('file', file);\n\n    try {\n      const response = await postIdImage(attachment);\n      setImageId(response.data.id);\n      setImageError(undefined);\n    } catch (error) {\n      setImageError(error.response.data);\n    }\n  };\n\n  const saveId = async () => {\n    if (!idNumber.match(numberRegex)) {\n      setError(\"Id number must be numeric\");\n      return;\n    }\n\n    const body = {\n      idNumber,\n      imageId,\n      loggedInUsername\n    };\n\n    try {\n      await putIdentity(body);\n      setError(undefined);\n      props.history.push('/');\n    } catch (error) {\n      setError(error.response.data);\n    }\n  };\n\n  const onChangeIdNumber = event => {\n    let digit = Math.max(Math.floor(Math.log10(Math.abs(event.target.value))), 0) + 1;\n\n    if (digit == 11) {\n      setIdError(undefined);\n    } else {\n      setIdError(\"Id number must be 11 digits\");\n    }\n\n    setIdNumber(event.target.value);\n    setError(undefined);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container card\",\n    style: {\n      background: '#f3f5f5'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-center card-header\",\n      children: \"ID Verification\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card-body\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"img-thumbnail\",\n        width: \"400\",\n        height: \"400\",\n        src: newImage,\n        alt: \"...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Input, {\n        label: \"Add ID photo\",\n        type: \"file\",\n        onChange: onChangeFile,\n        error: imageError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Input, {\n        label: \"ID number\",\n        type: \"text\",\n        onChange: onChangeIdNumber,\n        error: idError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-danger\",\n        role: \"alert\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 27\n      }, this), /*#__PURE__*/_jsxDEV(ButtonWithProgress, {\n        onClick: saveId,\n        text: \"Upload ID\",\n        disabled: idError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 9\n  }, this);\n};\n\n_s(VerifyAccount, \"kCR2xfJ5KzPvKr7VLphcIFreEOg=\", false, function () {\n  return [useSelector];\n});\n\n_c = VerifyAccount;\nexport default VerifyAccount;\n\nvar _c;\n\n$RefreshReg$(_c, \"VerifyAccount\");","map":{"version":3,"names":["React","Input","useEffect","useState","ButtonWithProgress","postIdImage","putIdentity","useSelector","VerifyAccount","props","error","setError","newImage","setNewImage","idNumber","setIdNumber","imageId","setImageId","imageError","setImageError","idError","setIdError","username","loggedInUsername","store","numberRegex","undefined","onChangeFile","event","target","files","length","file","fileReader","FileReader","onload","result","uploadFile","readAsDataURL","attachment","FormData","append","response","data","id","saveId","match","body","history","push","onChangeIdNumber","digit","Math","max","floor","log10","abs","value","background"],"sources":["C:/Users/bar1s/Desktop/react/auction/src/Components/VerifyAccount.js"],"sourcesContent":["import React from 'react';\r\nimport Input from './Input';\r\nimport { useEffect, useState } from 'react';\r\nimport ButtonWithProgress from './ButtonWithProgress';\r\nimport { postIdImage, putIdentity } from '../Api/ApiCalls';\r\nimport { useSelector } from 'react-redux';\r\n\r\nconst VerifyAccount = (props) => {\r\n\r\n    const [error, setError] = useState();\r\n    const [newImage, setNewImage] = useState();\r\n    const [idNumber, setIdNumber] = useState();\r\n    const [imageId, setImageId] = useState();\r\n    const [imageError, setImageError] = useState();\r\n    const [idError, setIdError] = useState();\r\n    const { username: loggedInUsername } = useSelector(store => ({ username: store.username }));\r\n    const numberRegex = /^[0-9]+$/;\r\n\r\n\r\n    useEffect(() => {\r\n        setError(undefined)\r\n    }, [newImage, idNumber]);\r\n\r\n    useEffect (() => {\r\n        setImageError(undefined)\r\n    } , [imageId]);\r\n\r\n    const onChangeFile = (event) => {\r\n        if (event.target.files.length < 1) {\r\n            return;\r\n        }\r\n        const file = event.target.files[0];\r\n        const fileReader = new FileReader();\r\n        fileReader.onload = () => {\r\n            setNewImage(fileReader.result);\r\n            uploadFile(file);\r\n        }\r\n        fileReader.readAsDataURL(file);\r\n    }\r\n\r\n    const uploadFile = async file => {\r\n        const attachment = new FormData();\r\n        attachment.append('file', file);\r\n        try {\r\n            const response = await postIdImage(attachment);\r\n            setImageId(response.data.id);\r\n            setImageError(undefined);\r\n        }catch(error){\r\n            setImageError(error.response.data);\r\n        }\r\n    };\r\n\r\n\r\n    const saveId = async () => {\r\n        if (!idNumber.match(numberRegex)) {\r\n            setError(\"Id number must be numeric\");\r\n            return;\r\n        }\r\n\r\n        const body = {\r\n            idNumber,\r\n            imageId,\r\n            loggedInUsername\r\n        }\r\n        try {\r\n            await putIdentity(body)\r\n            setError(undefined)\r\n            props.history.push('/');\r\n        } catch (error) {\r\n            setError(error.response.data);\r\n        }\r\n\r\n    }\r\n\r\n    const onChangeIdNumber = (event) => {\r\n        let digit = Math.max(Math.floor(Math.log10(Math.abs(event.target.value))), 0) + 1;\r\n        if (digit == 11) {\r\n            setIdError(undefined);\r\n        } else {\r\n            setIdError(\"Id number must be 11 digits\");\r\n        }\r\n        setIdNumber(event.target.value);\r\n        setError(undefined)\r\n    }\r\n\r\n\r\n    return (\r\n        <div className='container card' style={{ background: '#f3f5f5' }}>\r\n            <h2 className='text-center card-header'>ID Verification</h2>\r\n            <div className='card-body'>\r\n\r\n                <img className='img-thumbnail' width=\"400\" height=\"400\" src={newImage} alt='...' />\r\n\r\n                <Input label='Add ID photo' type=\"file\" onChange={onChangeFile} error={imageError } />\r\n                <hr />\r\n\r\n                <Input label='ID number' type=\"text\" onChange={onChangeIdNumber} error={idError} />\r\n\r\n                {error && <div className=\"alert alert-danger\" role=\"alert\">\r\n                    {error}\r\n                </div>}\r\n                <ButtonWithProgress onClick={saveId} text='Upload ID' disabled={idError} />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VerifyAccount;"],"mappings":"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"},"metadata":{},"sourceType":"module"}