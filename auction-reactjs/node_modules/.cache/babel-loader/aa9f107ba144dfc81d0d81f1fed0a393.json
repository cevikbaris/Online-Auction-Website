{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\bar1s\\\\Desktop\\\\react\\\\auction\\\\src\\\\Components\\\\VerifyAccount.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport Input from './Input';\nimport { useEffect, useState } from 'react';\nimport ButtonWithProgress from './ButtonWithProgress';\nimport { postIdImage, putIdentity } from '../Api/ApiCalls';\nimport { useSelector } from 'react-redux';\nimport { useParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst VerifyAccount = props => {\n  _s();\n\n  const [error, setError] = useState();\n  const [newImage, setNewImage] = useState();\n  const [idNumber, setIdNumber] = useState();\n  const [imageId, setImageId] = useState();\n  const [imageError, setImageError] = useState();\n  const [idError, setIdError] = useState();\n  const {\n    username: loggedInUsername\n  } = useSelector(store => ({\n    username: store.username\n  }));\n  const numberRegex = /^[0-9]+$/;\n  const routeParams = useParams();\n  const pathUsername = routeParams.username;\n  const isOwner = loggedInUsername === pathUsername;\n  useEffect(() => {\n    setError(undefined);\n  }, [newImage, idNumber]);\n  useEffect(() => {\n    setImageError(undefined);\n  }, [imageId]);\n\n  const onChangeFile = event => {\n    if (event.target.files.length < 1) {\n      return;\n    }\n\n    const file = event.target.files[0];\n    const fileReader = new FileReader();\n\n    fileReader.onload = () => {\n      setNewImage(fileReader.result);\n      uploadFile(file);\n    };\n\n    fileReader.readAsDataURL(file);\n  };\n\n  const uploadFile = async file => {\n    const attachment = new FormData();\n    attachment.append('file', file);\n\n    try {\n      const response = await postIdImage(attachment);\n      setImageId(response.data.id);\n      setImageError(undefined);\n    } catch (error) {\n      setImageError(error.response.data);\n    }\n  };\n\n  const saveId = async () => {\n    if (!idNumber.match(numberRegex)) {\n      setError(\"Id number must be numeric\");\n      return;\n    }\n\n    const body = {\n      idNumber,\n      imageId,\n      loggedInUsername\n    };\n\n    try {\n      await putIdentity(body);\n      setError(undefined);\n      props.history.push('/');\n    } catch (error) {\n      setError(error.response.data);\n    }\n  };\n\n  const onChangeIdNumber = event => {\n    let digit = Math.max(Math.floor(Math.log10(Math.abs(event.target.value))), 0) + 1;\n\n    if (digit == 11) {\n      setIdError(undefined);\n    } else {\n      setIdError(\"Id number must be 11 digits\");\n    }\n\n    setIdNumber(event.target.value);\n    setError(undefined);\n  };\n\n  let html = \"\";\n\n  if (isOwner) {\n    html = /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container card\",\n      style: {\n        background: '#f3f5f5'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-center card-header\",\n        children: \"ID Verification\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-body\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"img-thumbnail\",\n          width: \"400\",\n          height: \"400\",\n          src: newImage,\n          alt: \"...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          label: \"Add ID photo\",\n          type: \"file\",\n          onChange: onChangeFile,\n          error: imageError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          label: \"ID number\",\n          type: \"text\",\n          onChange: onChangeIdNumber,\n          error: idError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 17\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"alert alert-danger\",\n          role: \"alert\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 27\n        }, this), /*#__PURE__*/_jsxDEV(ButtonWithProgress, {\n          onClick: saveId,\n          text: \"Upload ID\",\n          disabled: idError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 17\n    }, this);\n  } else {\n    props.history.push('/');\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: html\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 9\n  }, this);\n};\n\n_s(VerifyAccount, \"8XVVcwAUYH66wQhUMEIctq9kp+U=\", false, function () {\n  return [useSelector, useParams];\n});\n\n_c = VerifyAccount;\nexport default VerifyAccount;\n\nvar _c;\n\n$RefreshReg$(_c, \"VerifyAccount\");","map":{"version":3,"names":["React","Input","useEffect","useState","ButtonWithProgress","postIdImage","putIdentity","useSelector","useParams","VerifyAccount","props","error","setError","newImage","setNewImage","idNumber","setIdNumber","imageId","setImageId","imageError","setImageError","idError","setIdError","username","loggedInUsername","store","numberRegex","routeParams","pathUsername","isOwner","undefined","onChangeFile","event","target","files","length","file","fileReader","FileReader","onload","result","uploadFile","readAsDataURL","attachment","FormData","append","response","data","id","saveId","match","body","history","push","onChangeIdNumber","digit","Math","max","floor","log10","abs","value","html","background"],"sources":["C:/Users/bar1s/Desktop/react/auction/src/Components/VerifyAccount.js"],"sourcesContent":["import React from 'react';\r\nimport Input from './Input';\r\nimport { useEffect, useState } from 'react';\r\nimport ButtonWithProgress from './ButtonWithProgress';\r\nimport { postIdImage, putIdentity } from '../Api/ApiCalls';\r\nimport { useSelector } from 'react-redux';\r\nimport { useParams } from 'react-router-dom';\r\n\r\n\r\nconst VerifyAccount = (props) => {\r\n\r\n    const [error, setError] = useState();\r\n    const [newImage, setNewImage] = useState();\r\n    const [idNumber, setIdNumber] = useState();\r\n    const [imageId, setImageId] = useState();\r\n    const [imageError, setImageError] = useState();\r\n    const [idError, setIdError] = useState();\r\n    const { username: loggedInUsername } = useSelector(store => ({ username: store.username }));\r\n    const numberRegex = /^[0-9]+$/;\r\n\r\n    const routeParams = useParams();\r\n    const pathUsername = routeParams.username;\r\n\r\n    const isOwner = loggedInUsername === pathUsername;\r\n\r\n    useEffect(() => {\r\n        setError(undefined)\r\n    }, [newImage, idNumber]);\r\n\r\n    useEffect(() => {\r\n        setImageError(undefined)\r\n    }, [imageId]);\r\n\r\n    const onChangeFile = (event) => {\r\n        if (event.target.files.length < 1) {\r\n            return;\r\n        }\r\n        const file = event.target.files[0];\r\n        const fileReader = new FileReader();\r\n        fileReader.onload = () => {\r\n            setNewImage(fileReader.result);\r\n            uploadFile(file);\r\n        }\r\n        fileReader.readAsDataURL(file);\r\n    }\r\n\r\n    const uploadFile = async file => {\r\n        const attachment = new FormData();\r\n        attachment.append('file', file);\r\n        try {\r\n            const response = await postIdImage(attachment);\r\n            setImageId(response.data.id);\r\n            setImageError(undefined);\r\n        } catch (error) {\r\n            setImageError(error.response.data);\r\n        }\r\n    };\r\n\r\n\r\n    const saveId = async () => {\r\n        if (!idNumber.match(numberRegex)) {\r\n            setError(\"Id number must be numeric\");\r\n            return;\r\n        }\r\n\r\n        const body = {\r\n            idNumber,\r\n            imageId,\r\n            loggedInUsername\r\n        }\r\n        try {\r\n            await putIdentity(body)\r\n            setError(undefined)\r\n            props.history.push('/');\r\n        } catch (error) {\r\n            setError(error.response.data);\r\n        }\r\n\r\n    }\r\n\r\n    const onChangeIdNumber = (event) => {\r\n        let digit = Math.max(Math.floor(Math.log10(Math.abs(event.target.value))), 0) + 1;\r\n        if (digit == 11) {\r\n            setIdError(undefined);\r\n        } else {\r\n            setIdError(\"Id number must be 11 digits\");\r\n        }\r\n        setIdNumber(event.target.value);\r\n        setError(undefined)\r\n    }\r\n\r\n    let html = \"\";\r\n    if (isOwner) {\r\n        html = (<div className='container card' style={{ background: '#f3f5f5' }}>\r\n            <h2 className='text-center card-header'>ID Verification</h2>\r\n            <div className='card-body'>\r\n\r\n                <img className='img-thumbnail' width=\"400\" height=\"400\" src={newImage} alt='...' />\r\n\r\n                <Input label='Add ID photo' type=\"file\" onChange={onChangeFile} error={imageError} />\r\n                <hr />\r\n\r\n                <Input label='ID number' type=\"text\" onChange={onChangeIdNumber} error={idError} />\r\n\r\n                {error && <div className=\"alert alert-danger\" role=\"alert\">\r\n                    {error}\r\n                </div>}\r\n                <ButtonWithProgress onClick={saveId} text='Upload ID' disabled={idError} />\r\n            </div>\r\n        </div>\r\n        )\r\n    }else{\r\n        props.history.push('/');\r\n    }\r\n\r\n\r\n    return (\r\n        <div>\r\n            {html}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VerifyAccount;"],"mappings":"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"},"metadata":{},"sourceType":"module"}