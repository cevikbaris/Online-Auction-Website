{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/bar1s/Desktop/react/auction/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/bar1s/Desktop/react/auction/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/bar1s/Desktop/react/auction/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import Input from'../Components/Input';import ButtonWithProgress from'../Components/ButtonWithProgress';import{useApiProgress}from'../Shared/ApiProgress';import{useDispatch}from'react-redux';import{loginHandler}from'../Redux/Actions';import{useSelector}from'react-redux';import{Link}from'react-router-dom';import'./loginPage.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginPage=function LoginPage(props){var roles=useSelector(function(store){return store.roles;});var roleNames=roles.map(function(role){return role.name;});var _useState=useState(),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var dispatch=useDispatch();useEffect(function(){setError(undefined);},[username,password]);var onClickLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var creds,history,push,response,_roles;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();creds={username:username,password:password};history=props.history;push=history.push;setError(undefined);_context.prev=5;_context.next=8;return dispatch(loginHandler(creds));case 8:response=_context.sent;_roles=response.data.role;if(_roles.length>1){push('/admin');}else{push('/');}_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](5);if(_context.t0.response.data.message===\"Unauthorized\"){setError(\"Username or password is incorrect\");}else{setError(_context.t0.response.data.message);}case 16:case\"end\":return _context.stop();}}},_callee,null,[[5,13]]);}));return function onClickLogin(_x){return _ref.apply(this,arguments);};}();var buttonEnabled=username&&password;var pendingApiCall=useApiProgress('post','/auth',true);return/*#__PURE__*/_jsx(\"div\",{className:\" gradient-custom\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container py-5 h-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row d-flex justify-content-center align-items-center h-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-md-8 col-lg-6 col-xl-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card bg-dark text-white\",style:{\"border-radius\":\"1rem\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body p-5 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-md-5 mt-md-4 pb-5\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"fw-bold mb-2 text-uppercase\",children:\"Login\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white-50 mb-5\",children:\"Please enter your Username and password!\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-outline form-white mb-4\",children:/*#__PURE__*/_jsx(Input,{label:\"Username\",onChange:function onChange(event){return setUsername(event.target.value);}})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-outline form-white mb-4\",children:/*#__PURE__*/_jsx(Input,{label:\"Password\",type:\"password\",onChange:function onChange(event){return setPassword(event.target.value);}})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:error}),/*#__PURE__*/_jsx(ButtonWithProgress,{onClick:onClickLogin,disabled:!buttonEnabled||pendingApiCall,pendingApiCall:pendingApiCall,text:'Login'})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0\",children:[\"Don't have an account? \",/*#__PURE__*/_jsx(Link,{to:\"/signup\",className:\"text-white-50 fw-bold\",children:\"Sign Up\"})]})})]})})})})})});};export default LoginPage;","map":{"version":3,"names":["React","useEffect","useState","Input","ButtonWithProgress","useApiProgress","useDispatch","loginHandler","useSelector","Link","LoginPage","props","roles","store","roleNames","map","role","name","username","setUsername","password","setPassword","error","setError","dispatch","undefined","onClickLogin","event","preventDefault","creds","history","push","response","data","length","message","buttonEnabled","pendingApiCall","target","value"],"sources":["C:/Users/bar1s/Desktop/react/auction/src/Pages/LoginPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport Input from '../Components/Input';\r\nimport ButtonWithProgress from '../Components/ButtonWithProgress';\r\nimport { useApiProgress } from '../Shared/ApiProgress';\r\nimport { useDispatch } from 'react-redux';\r\nimport { loginHandler } from '../Redux/Actions';\r\nimport { useSelector } from 'react-redux';\r\nimport { Link } from 'react-router-dom';\r\nimport './loginPage.css'\r\n\r\nconst LoginPage = (props) => {\r\n    const roles = useSelector(store => store.roles);\r\n    const roleNames = roles.map(role => role.name);\r\n\r\n\r\n\r\n    const [username, setUsername] = useState();\r\n    const [password, setPassword] = useState();\r\n    const [error, setError] = useState();\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        setError(undefined)\r\n    }, [username, password])\r\n\r\n    const onClickLogin = async (event) => {\r\n        event.preventDefault();\r\n\r\n        const creds = { username, password };\r\n\r\n        const { history } = props;\r\n        const { push } = history;\r\n        setError(undefined);\r\n        try {\r\n            const response = await dispatch(loginHandler(creds));\r\n            const roles = response.data.role;\r\n            if (roles.length > 1) {\r\n                push('/admin');\r\n            } else {\r\n                push('/');\r\n            }\r\n\r\n\r\n        } catch (error) {\r\n            if (error.response.data.message === \"Unauthorized\") {\r\n                setError(\"Username or password is incorrect\");\r\n            } else {\r\n                setError(error.response.data.message)\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    const buttonEnabled = username && password;\r\n    const pendingApiCall = useApiProgress('post', '/auth', true);\r\n\r\n\r\n    return (\r\n        <div className=\" gradient-custom\">\r\n            <div className=\"container py-5 h-100\">\r\n                <div className=\"row d-flex justify-content-center align-items-center h-100\">\r\n                    <div className=\"col-12 col-md-8 col-lg-6 col-xl-5\">\r\n                        <div className=\"card bg-dark text-white\" style={{ \"border-radius\": \"1rem\" }} >\r\n                            <div className=\"card-body p-5 text-center\">\r\n\r\n                                <div className=\"mb-md-5 mt-md-4 pb-5\">\r\n\r\n                                    <h2 className=\"fw-bold mb-2 text-uppercase\">Login</h2>\r\n                                    <p className=\"text-white-50 mb-5\">Please enter your Username and password!</p>\r\n\r\n                                    <div className=\"form-outline form-white mb-4\">\r\n                                        <Input label='Username' onChange={event => setUsername(event.target.value)} />\r\n                                    </div>\r\n\r\n                                    <div className=\"form-outline form-white mb-4\">\r\n                                        <Input label='Password' type='password' onChange={event => setPassword(event.target.value)} />\r\n                                    </div>\r\n                                    {error && <div className='alert alert-danger'>{error}</div>}\r\n\r\n                                    <ButtonWithProgress\r\n                                        onClick={onClickLogin}\r\n                                        disabled={!buttonEnabled || pendingApiCall}\r\n                                        pendingApiCall={pendingApiCall}\r\n                                        text={'Login'} />\r\n\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <p className=\"mb-0\">Don't have an account? <Link to='/signup' className=\"text-white-50 fw-bold\">Sign Up</Link>\r\n                                    </p>\r\n                                </div>\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    );\r\n};\r\n\r\nexport default LoginPage;"],"mappings":"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"},"metadata":{},"sourceType":"module"}